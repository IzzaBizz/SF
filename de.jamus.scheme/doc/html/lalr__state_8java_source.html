<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Jamus Scheme: src/java_cup/lalr_state.java Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Jamus Scheme
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('lalr__state_8java.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">src/java_cup/lalr_state.java</div>  </div>
</div><!--header-->
<div class="contents">
<a href="lalr__state_8java.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00002"></a>00002 <span class="keyword">package </span>java_cup;
<a name="l00003"></a>00003 
<a name="l00004"></a>00004 <span class="keyword">import</span> java.util.Hashtable;
<a name="l00005"></a>00005 <span class="keyword">import</span> java.util.Enumeration;
<a name="l00006"></a>00006 <span class="keyword">import</span> java.util.Stack;
<a name="l00007"></a>00007 
<a name="l00052"></a><a class="code" href="classjava__cup_1_1lalr__state.html">00052</a> <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classjava__cup_1_1lalr__state.html">lalr_state</a> {
<a name="l00053"></a>00053   <span class="comment">/*-----------------------------------------------------------*/</span>
<a name="l00054"></a>00054   <span class="comment">/*--- Constructor(s) ----------------------------------------*/</span>
<a name="l00055"></a>00055   <span class="comment">/*-----------------------------------------------------------*/</span>
<a name="l00056"></a>00056        
<a name="l00060"></a><a class="code" href="classjava__cup_1_1lalr__state.html#add09dab23ebc0e40de79febe653cc7b4">00060</a>   <span class="keyword">public</span> <a class="code" href="classjava__cup_1_1lalr__state.html#add09dab23ebc0e40de79febe653cc7b4">lalr_state</a>(<a class="code" href="classjava__cup_1_1lalr__item__set.html">lalr_item_set</a> itms) <span class="keywordflow">throws</span> <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>
<a name="l00061"></a>00061    {
<a name="l00062"></a>00062      <span class="comment">/* don&#39;t allow null or duplicate item sets */</span>
<a name="l00063"></a>00063      <span class="keywordflow">if</span> (itms == null)
<a name="l00064"></a>00064        <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>(
<a name="l00065"></a>00065          <span class="stringliteral">&quot;Attempt to construct an LALR state from a null item set&quot;</span>);
<a name="l00066"></a>00066 
<a name="l00067"></a>00067      <span class="keywordflow">if</span> (<a class="code" href="classjava__cup_1_1lalr__state.html#ac70f9ce9782a839e7311aa2c8ac2dcf3">find_state</a>(itms) != null)
<a name="l00068"></a>00068        <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>(
<a name="l00069"></a>00069          <span class="stringliteral">&quot;Attempt to construct a duplicate LALR state&quot;</span>);
<a name="l00070"></a>00070 
<a name="l00071"></a>00071      <span class="comment">/* assign a unique index */</span>
<a name="l00072"></a>00072       <a class="code" href="classjava__cup_1_1lalr__state.html#a4666222da645e9d587e0eb5ce06c4e34">_index</a> = <a class="code" href="classjava__cup_1_1lalr__state.html#a5d25e665ad17b63888b48c2b4ac1ea83">next_index</a>++;
<a name="l00073"></a>00073 
<a name="l00074"></a>00074      <span class="comment">/* store the items */</span>
<a name="l00075"></a>00075      <a class="code" href="classjava__cup_1_1lalr__state.html#ad33394e5cb5e5bedd773c6f24f4bf10d">_items</a> = itms;
<a name="l00076"></a>00076 
<a name="l00077"></a>00077      <span class="comment">/* add to the global collection, keyed with its item set */</span>
<a name="l00078"></a>00078      <a class="code" href="classjava__cup_1_1lalr__state.html#a29fba5f54f53da9abf2704dc866cdefc">_all</a>.put(<a class="code" href="classjava__cup_1_1lalr__state.html#ad33394e5cb5e5bedd773c6f24f4bf10d">_items</a>,<span class="keyword">this</span>);
<a name="l00079"></a>00079    }
<a name="l00080"></a>00080 
<a name="l00081"></a>00081   <span class="comment">/*-----------------------------------------------------------*/</span>
<a name="l00082"></a>00082   <span class="comment">/*--- (Access to) Static (Class) Variables ------------------*/</span>
<a name="l00083"></a>00083   <span class="comment">/*-----------------------------------------------------------*/</span>
<a name="l00084"></a>00084 
<a name="l00086"></a><a class="code" href="classjava__cup_1_1lalr__state.html#a29fba5f54f53da9abf2704dc866cdefc">00086</a>   <span class="keyword">protected</span> <span class="keyword">static</span> Hashtable <a class="code" href="classjava__cup_1_1lalr__state.html#a29fba5f54f53da9abf2704dc866cdefc">_all</a> = <span class="keyword">new</span> Hashtable();
<a name="l00087"></a>00087 
<a name="l00089"></a><a class="code" href="classjava__cup_1_1lalr__state.html#a1fbb9402cedc4be04f3900f34fb41c35">00089</a>   <span class="keyword">public</span> <span class="keyword">static</span> Enumeration <a class="code" href="classjava__cup_1_1lalr__state.html#a1fbb9402cedc4be04f3900f34fb41c35">all</a>() {<span class="keywordflow">return</span> <a class="code" href="classjava__cup_1_1lalr__state.html#a29fba5f54f53da9abf2704dc866cdefc">_all</a>.elements();}
<a name="l00090"></a>00090 
<a name="l00091"></a>00091   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00092"></a>00092 
<a name="l00094"></a><a class="code" href="classjava__cup_1_1lalr__state.html#ada0e039a8b6dc81f861863c9936ceed8">00094</a>   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classjava__cup_1_1lalr__state.html#ada0e039a8b6dc81f861863c9936ceed8">number</a>() {<span class="keywordflow">return</span> <a class="code" href="classjava__cup_1_1lalr__state.html#a29fba5f54f53da9abf2704dc866cdefc">_all</a>.size();}
<a name="l00095"></a>00095 
<a name="l00096"></a>00096   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00097"></a>00097 
<a name="l00102"></a><a class="code" href="classjava__cup_1_1lalr__state.html#aa9df91fa0bfd008b07cbfc004a88296d">00102</a>   <span class="keyword">protected</span> <span class="keyword">static</span> Hashtable <a class="code" href="classjava__cup_1_1lalr__state.html#aa9df91fa0bfd008b07cbfc004a88296d">_all_kernels</a> = <span class="keyword">new</span> Hashtable();
<a name="l00103"></a>00103 
<a name="l00104"></a>00104   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00105"></a>00105 
<a name="l00113"></a><a class="code" href="classjava__cup_1_1lalr__state.html#ac70f9ce9782a839e7311aa2c8ac2dcf3">00113</a>   <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="classjava__cup_1_1lalr__state.html">lalr_state</a> <a class="code" href="classjava__cup_1_1lalr__state.html#ac70f9ce9782a839e7311aa2c8ac2dcf3">find_state</a>(<a class="code" href="classjava__cup_1_1lalr__item__set.html">lalr_item_set</a> itms)
<a name="l00114"></a>00114     {
<a name="l00115"></a>00115       <span class="keywordflow">if</span> (itms == null) 
<a name="l00116"></a>00116         <span class="keywordflow">return</span> null;
<a name="l00117"></a>00117       <span class="keywordflow">else</span>
<a name="l00118"></a>00118         <span class="keywordflow">return</span> (<a class="code" href="classjava__cup_1_1lalr__state.html">lalr_state</a>)<a class="code" href="classjava__cup_1_1lalr__state.html#a29fba5f54f53da9abf2704dc866cdefc">_all</a>.get(itms);
<a name="l00119"></a>00119     }
<a name="l00120"></a>00120 
<a name="l00121"></a>00121   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00122"></a>00122 
<a name="l00124"></a><a class="code" href="classjava__cup_1_1lalr__state.html#a5d25e665ad17b63888b48c2b4ac1ea83">00124</a>   <span class="keyword">protected</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classjava__cup_1_1lalr__state.html#a5d25e665ad17b63888b48c2b4ac1ea83">next_index</a> = 0;
<a name="l00125"></a>00125 
<a name="l00126"></a>00126   <span class="comment">/*-----------------------------------------------------------*/</span>
<a name="l00127"></a>00127   <span class="comment">/*--- (Access to) Instance Variables ------------------------*/</span>
<a name="l00128"></a>00128   <span class="comment">/*-----------------------------------------------------------*/</span>
<a name="l00129"></a>00129 
<a name="l00131"></a><a class="code" href="classjava__cup_1_1lalr__state.html#ad33394e5cb5e5bedd773c6f24f4bf10d">00131</a>   <span class="keyword">protected</span> <a class="code" href="classjava__cup_1_1lalr__item__set.html">lalr_item_set</a> <a class="code" href="classjava__cup_1_1lalr__state.html#ad33394e5cb5e5bedd773c6f24f4bf10d">_items</a>;
<a name="l00132"></a>00132 
<a name="l00134"></a><a class="code" href="classjava__cup_1_1lalr__state.html#a79f7c20c7a43b52f36dfd4531c824732">00134</a>   <span class="keyword">public</span> <a class="code" href="classjava__cup_1_1lalr__item__set.html">lalr_item_set</a> <a class="code" href="classjava__cup_1_1lalr__state.html#a79f7c20c7a43b52f36dfd4531c824732">items</a>() {<span class="keywordflow">return</span> <a class="code" href="classjava__cup_1_1lalr__state.html#ad33394e5cb5e5bedd773c6f24f4bf10d">_items</a>;}
<a name="l00135"></a>00135 
<a name="l00136"></a>00136   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00137"></a>00137 
<a name="l00139"></a><a class="code" href="classjava__cup_1_1lalr__state.html#a56c5af0c5c3311a3924a189e5d78488c">00139</a>   <span class="keyword">protected</span> <a class="code" href="classjava__cup_1_1lalr__transition.html">lalr_transition</a> <a class="code" href="classjava__cup_1_1lalr__state.html#a56c5af0c5c3311a3924a189e5d78488c">_transitions</a> = null;
<a name="l00140"></a>00140 
<a name="l00142"></a><a class="code" href="classjava__cup_1_1lalr__state.html#ad3c1f8e5f82060f48717a8a4a7561fc1">00142</a>   <span class="keyword">public</span> <a class="code" href="classjava__cup_1_1lalr__transition.html">lalr_transition</a> <a class="code" href="classjava__cup_1_1lalr__state.html#ad3c1f8e5f82060f48717a8a4a7561fc1">transitions</a>() {<span class="keywordflow">return</span> <a class="code" href="classjava__cup_1_1lalr__state.html#a56c5af0c5c3311a3924a189e5d78488c">_transitions</a>;}
<a name="l00143"></a>00143 
<a name="l00144"></a>00144   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00145"></a>00145 
<a name="l00147"></a><a class="code" href="classjava__cup_1_1lalr__state.html#a4666222da645e9d587e0eb5ce06c4e34">00147</a>   <span class="keyword">protected</span> <span class="keywordtype">int</span> <a class="code" href="classjava__cup_1_1lalr__state.html#a4666222da645e9d587e0eb5ce06c4e34">_index</a>;
<a name="l00148"></a>00148 
<a name="l00150"></a><a class="code" href="classjava__cup_1_1lalr__state.html#a4739bfae64234f684f099013d301522c">00150</a>   <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classjava__cup_1_1lalr__state.html#a4739bfae64234f684f099013d301522c">index</a>() {<span class="keywordflow">return</span> <a class="code" href="classjava__cup_1_1lalr__state.html#a4666222da645e9d587e0eb5ce06c4e34">_index</a>;}
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   <span class="comment">/*-----------------------------------------------------------*/</span>
<a name="l00153"></a>00153   <span class="comment">/*--- Static Methods ----------------------------------------*/</span>
<a name="l00154"></a>00154   <span class="comment">/*-----------------------------------------------------------*/</span>
<a name="l00155"></a>00155 
<a name="l00159"></a><a class="code" href="classjava__cup_1_1lalr__state.html#a229e006a60f28ad4f2cb5ef8dad29093">00159</a>   <span class="keyword">protected</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classjava__cup_1_1lalr__state.html#a229e006a60f28ad4f2cb5ef8dad29093">dump_state</a>(<a class="code" href="classjava__cup_1_1lalr__state.html">lalr_state</a> st) <span class="keywordflow">throws</span> <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>
<a name="l00160"></a>00160     {
<a name="l00161"></a>00161       <a class="code" href="classjava__cup_1_1lalr__item__set.html">lalr_item_set</a> itms;
<a name="l00162"></a>00162       <a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a> itm;
<a name="l00163"></a>00163       <a class="code" href="classjava__cup_1_1production__part.html">production_part</a> part;
<a name="l00164"></a>00164 
<a name="l00165"></a>00165       <span class="keywordflow">if</span> (st == null) 
<a name="l00166"></a>00166         {
<a name="l00167"></a>00167           System.out.println(<span class="stringliteral">&quot;NULL lalr_state&quot;</span>);
<a name="l00168"></a>00168           <span class="keywordflow">return</span>;
<a name="l00169"></a>00169         }
<a name="l00170"></a>00170 
<a name="l00171"></a>00171       System.out.println(<span class="stringliteral">&quot;lalr_state [&quot;</span> + st.index() + <span class="stringliteral">&quot;] {&quot;</span>);
<a name="l00172"></a>00172       itms = st.items();
<a name="l00173"></a>00173       <span class="keywordflow">for</span> (Enumeration e = itms.<a class="code" href="classjava__cup_1_1lalr__item__set.html#ab276bc588c75f4f22e46baf01bbcd0b7">all</a>(); e.hasMoreElements(); )
<a name="l00174"></a>00174         {
<a name="l00175"></a>00175           itm = (<a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a>)e.nextElement();
<a name="l00176"></a>00176           System.out.print(<span class="stringliteral">&quot;  [&quot;</span>);
<a name="l00177"></a>00177           System.out.print(itm.<a class="code" href="classjava__cup_1_1lr__item__core.html#a9204bcb89701764f202ad5bc158aeb38">the_production</a>().<a class="code" href="classjava__cup_1_1production.html#ab1d84dd19ab5b1baa56d8a7143d646b4">lhs</a>().<a class="code" href="classjava__cup_1_1symbol__part.html#a5acfa0ec5253bc3481bf93719cd8e8d8">the_symbol</a>().<a class="code" href="classjava__cup_1_1symbol.html#a2886f199df09de270d6ee498f7044793">name</a>());
<a name="l00178"></a>00178           System.out.print(<span class="stringliteral">&quot; ::= &quot;</span>);
<a name="l00179"></a>00179           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt;itm.<a class="code" href="classjava__cup_1_1lr__item__core.html#a9204bcb89701764f202ad5bc158aeb38">the_production</a>().<a class="code" href="classjava__cup_1_1production.html#a10a0d078dc38ec32281aa591a9d4684f">rhs_length</a>(); i++)
<a name="l00180"></a>00180             {
<a name="l00181"></a>00181               <span class="keywordflow">if</span> (i == itm.<a class="code" href="classjava__cup_1_1lr__item__core.html#a107845a94cf3ef7854967afba9a6e3c9">dot_pos</a>()) System.out.print(<span class="stringliteral">&quot;(*) &quot;</span>);
<a name="l00182"></a>00182               part = itm.<a class="code" href="classjava__cup_1_1lr__item__core.html#a9204bcb89701764f202ad5bc158aeb38">the_production</a>().<a class="code" href="classjava__cup_1_1production.html#aa88a224724f72ff013f5f57cad4d5480">rhs</a>(i);
<a name="l00183"></a>00183               <span class="keywordflow">if</span> (part.<a class="code" href="classjava__cup_1_1production__part.html#a11952af690f0281a885ce4015e68296b">is_action</a>()) 
<a name="l00184"></a>00184                 System.out.print(<span class="stringliteral">&quot;{action} &quot;</span>);
<a name="l00185"></a>00185               <span class="keywordflow">else</span>
<a name="l00186"></a>00186                 System.out.print(((<a class="code" href="classjava__cup_1_1symbol__part.html">symbol_part</a>)part).the_symbol().name() + <span class="stringliteral">&quot; &quot;</span>);
<a name="l00187"></a>00187             }
<a name="l00188"></a>00188           <span class="keywordflow">if</span> (itm.<a class="code" href="classjava__cup_1_1lr__item__core.html#ae3056b0c70648240cc9682f2af398d45">dot_at_end</a>()) System.out.print(<span class="stringliteral">&quot;(*) &quot;</span>);
<a name="l00189"></a>00189           System.out.println(<span class="stringliteral">&quot;]&quot;</span>);
<a name="l00190"></a>00190         }
<a name="l00191"></a>00191       System.out.println(<span class="stringliteral">&quot;}&quot;</span>);
<a name="l00192"></a>00192     }
<a name="l00193"></a>00193 
<a name="l00194"></a>00194   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00195"></a>00195 
<a name="l00203"></a><a class="code" href="classjava__cup_1_1lalr__state.html#a1392280a8e0cbafed1a2998d07ee5712">00203</a>   <span class="keyword">protected</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classjava__cup_1_1lalr__state.html#a1392280a8e0cbafed1a2998d07ee5712">propagate_all_lookaheads</a>() throws <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>
<a name="l00204"></a>00204     {
<a name="l00205"></a>00205       <span class="comment">/* iterate across all states */</span>
<a name="l00206"></a>00206       <span class="keywordflow">for</span> (Enumeration st = <a class="code" href="classjava__cup_1_1lalr__state.html#a1fbb9402cedc4be04f3900f34fb41c35">all</a>(); st.hasMoreElements(); )
<a name="l00207"></a>00207         {
<a name="l00208"></a>00208           <span class="comment">/* propagate lookaheads out of that state */</span>
<a name="l00209"></a>00209           ((<a class="code" href="classjava__cup_1_1lalr__state.html#add09dab23ebc0e40de79febe653cc7b4">lalr_state</a>)st.nextElement()).<a class="code" href="classjava__cup_1_1lalr__state.html#a62f863be0ab72998e795368d548187bc">propagate_lookaheads</a>();
<a name="l00210"></a>00210         }
<a name="l00211"></a>00211     }
<a name="l00212"></a>00212 
<a name="l00213"></a>00213   <span class="comment">/*-----------------------------------------------------------*/</span>
<a name="l00214"></a>00214   <span class="comment">/*--- General Methods ---------------------------------------*/</span>
<a name="l00215"></a>00215   <span class="comment">/*-----------------------------------------------------------*/</span>
<a name="l00216"></a>00216 
<a name="l00221"></a><a class="code" href="classjava__cup_1_1lalr__state.html#aaccbf90f93da595e05ff7da4ebc4c4ce">00221</a>   <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classjava__cup_1_1lalr__state.html#aaccbf90f93da595e05ff7da4ebc4c4ce">add_transition</a>(<a class="code" href="classjava__cup_1_1symbol.html">symbol</a> on_sym, <a class="code" href="classjava__cup_1_1lalr__state.html">lalr_state</a> to_st) 
<a name="l00222"></a>00222     <span class="keywordflow">throws</span> <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>
<a name="l00223"></a>00223     {
<a name="l00224"></a>00224       <a class="code" href="classjava__cup_1_1lalr__transition.html">lalr_transition</a> trans;
<a name="l00225"></a>00225 
<a name="l00226"></a>00226       <span class="comment">/* create a new transition object and put it in our list */</span>
<a name="l00227"></a>00227       trans = <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1lalr__transition.html">lalr_transition</a>(on_sym, to_st, <a class="code" href="classjava__cup_1_1lalr__state.html#a56c5af0c5c3311a3924a189e5d78488c">_transitions</a>);
<a name="l00228"></a>00228       <a class="code" href="classjava__cup_1_1lalr__state.html#a56c5af0c5c3311a3924a189e5d78488c">_transitions</a> = trans;
<a name="l00229"></a>00229     }
<a name="l00230"></a>00230 
<a name="l00231"></a>00231   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00232"></a>00232 
<a name="l00271"></a><a class="code" href="classjava__cup_1_1lalr__state.html#ad7a493973dc1622375005c721f2d2585">00271</a>   <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="classjava__cup_1_1lalr__state.html">lalr_state</a> <a class="code" href="classjava__cup_1_1lalr__state.html#ad7a493973dc1622375005c721f2d2585">build_machine</a>(<a class="code" href="classjava__cup_1_1production.html">production</a> start_prod) 
<a name="l00272"></a>00272     <span class="keywordflow">throws</span> <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>
<a name="l00273"></a>00273     {
<a name="l00274"></a>00274       <a class="code" href="classjava__cup_1_1lalr__state.html">lalr_state</a>    start_state;
<a name="l00275"></a>00275       <a class="code" href="classjava__cup_1_1lalr__item__set.html">lalr_item_set</a> start_items;
<a name="l00276"></a>00276       <a class="code" href="classjava__cup_1_1lalr__item__set.html">lalr_item_set</a> new_items;
<a name="l00277"></a>00277       <a class="code" href="classjava__cup_1_1lalr__item__set.html">lalr_item_set</a> linked_items;
<a name="l00278"></a>00278       <a class="code" href="classjava__cup_1_1lalr__item__set.html">lalr_item_set</a> kernel;
<a name="l00279"></a>00279       Stack         work_stack = <span class="keyword">new</span> Stack();
<a name="l00280"></a>00280       <a class="code" href="classjava__cup_1_1lalr__state.html">lalr_state</a>    st, new_st;
<a name="l00281"></a>00281       <a class="code" href="classjava__cup_1_1symbol__set.html">symbol_set</a>    outgoing;
<a name="l00282"></a>00282       <a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a>     itm, new_itm, existing, fix_itm;
<a name="l00283"></a>00283       <a class="code" href="classjava__cup_1_1symbol.html">symbol</a>        <a class="code" href="classjava__cup_1_1sym.html">sym</a>, sym2;
<a name="l00284"></a>00284       Enumeration   i, s, fix;
<a name="l00285"></a>00285 
<a name="l00286"></a>00286       <span class="comment">/* sanity check */</span>
<a name="l00287"></a>00287       <span class="keywordflow">if</span> (start_prod == null)
<a name="l00288"></a>00288         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>(
<a name="l00289"></a>00289           <span class="stringliteral">&quot;Attempt to build viable prefix recognizer using a null production&quot;</span>);
<a name="l00290"></a>00290 
<a name="l00291"></a>00291       <span class="comment">/* build item with dot at front of start production and EOF lookahead */</span>
<a name="l00292"></a>00292       start_items = <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1lalr__item__set.html">lalr_item_set</a>();
<a name="l00293"></a>00293 
<a name="l00294"></a>00294       itm = <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a>(start_prod);
<a name="l00295"></a>00295       itm.<a class="code" href="classjava__cup_1_1lalr__item.html#a7deb179749d6f1cd97987f1aa6007ec1">lookahead</a>().<a class="code" href="classjava__cup_1_1terminal__set.html#a073ab4492e122cfa6eb75e729b81db78">add</a>(<a class="code" href="classjava__cup_1_1terminal.html">terminal</a>.<a class="code" href="classjava__cup_1_1terminal.html#a3123653719e82c16531d18a1ff4e423f">EOF</a>);
<a name="l00296"></a>00296 
<a name="l00297"></a>00297       start_items.<a class="code" href="classjava__cup_1_1lalr__item__set.html#a9da97681085e4ce96f31a2dce50b987d">add</a>(itm);
<a name="l00298"></a>00298 
<a name="l00299"></a>00299       <span class="comment">/* create copy the item set to form the kernel */</span>
<a name="l00300"></a>00300       kernel = <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1lalr__item__set.html">lalr_item_set</a>(start_items);
<a name="l00301"></a>00301 
<a name="l00302"></a>00302       <span class="comment">/* create the closure from that item set */</span>
<a name="l00303"></a>00303       start_items.<a class="code" href="classjava__cup_1_1lalr__item__set.html#a9e30f462eb3299ee022fe5c9ff01ef71">compute_closure</a>();
<a name="l00304"></a>00304 
<a name="l00305"></a>00305       <span class="comment">/* build a state out of that item set and put it in our work set */</span>
<a name="l00306"></a>00306       start_state = <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1lalr__state.html#add09dab23ebc0e40de79febe653cc7b4">lalr_state</a>(start_items);
<a name="l00307"></a>00307       work_stack.push(start_state);
<a name="l00308"></a>00308 
<a name="l00309"></a>00309       <span class="comment">/* enter the state using the kernel as the key */</span>
<a name="l00310"></a>00310       <a class="code" href="classjava__cup_1_1lalr__state.html#aa9df91fa0bfd008b07cbfc004a88296d">_all_kernels</a>.put(kernel, start_state);
<a name="l00311"></a>00311 
<a name="l00312"></a>00312       <span class="comment">/* continue looking at new states until we have no more work to do */</span>
<a name="l00313"></a>00313       <span class="keywordflow">while</span> (!work_stack.empty())
<a name="l00314"></a>00314         {
<a name="l00315"></a>00315           <span class="comment">/* remove a state from the work set */</span>
<a name="l00316"></a>00316           st = (<a class="code" href="classjava__cup_1_1lalr__state.html#add09dab23ebc0e40de79febe653cc7b4">lalr_state</a>)work_stack.pop();
<a name="l00317"></a>00317 
<a name="l00318"></a>00318           <span class="comment">/* gather up all the symbols that appear before dots */</span>
<a name="l00319"></a>00319           outgoing = <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1symbol__set.html">symbol_set</a>();
<a name="l00320"></a>00320           <span class="keywordflow">for</span> (i = st.<a class="code" href="classjava__cup_1_1lalr__state.html#a79f7c20c7a43b52f36dfd4531c824732">items</a>().<a class="code" href="classjava__cup_1_1lalr__item__set.html#ab276bc588c75f4f22e46baf01bbcd0b7">all</a>(); i.hasMoreElements(); )
<a name="l00321"></a>00321             {
<a name="l00322"></a>00322               itm = (<a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a>)i.nextElement();
<a name="l00323"></a>00323 
<a name="l00324"></a>00324               <span class="comment">/* add the symbol before the dot (if any) to our collection */</span>
<a name="l00325"></a>00325               sym = itm.<a class="code" href="classjava__cup_1_1lr__item__core.html#a46e27ab1d918219e48e9720a834b2393">symbol_after_dot</a>();
<a name="l00326"></a>00326               <span class="keywordflow">if</span> (sym != null) outgoing.<a class="code" href="classjava__cup_1_1symbol__set.html#ad90ade42cf131fcedafcafc375873ef9">add</a>(sym);
<a name="l00327"></a>00327             }
<a name="l00328"></a>00328 
<a name="l00329"></a>00329           <span class="comment">/* now create a transition out for each individual symbol */</span>
<a name="l00330"></a>00330           <span class="keywordflow">for</span> (s = outgoing.<a class="code" href="classjava__cup_1_1symbol__set.html#a025d87de8a4d8a323303bbbd0168332e">all</a>(); s.hasMoreElements(); )
<a name="l00331"></a>00331             {
<a name="l00332"></a>00332               sym = (<a class="code" href="classjava__cup_1_1symbol.html">symbol</a>)s.nextElement();
<a name="l00333"></a>00333 
<a name="l00334"></a>00334               <span class="comment">/* will be keeping the set of items with propagate links */</span>
<a name="l00335"></a>00335               linked_items = <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1lalr__item__set.html">lalr_item_set</a>();
<a name="l00336"></a>00336 
<a name="l00337"></a>00337               <span class="comment">/* gather up shifted versions of all the items that have this</span>
<a name="l00338"></a>00338 <span class="comment">                 symbol before the dot */</span>
<a name="l00339"></a>00339               new_items = <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1lalr__item__set.html">lalr_item_set</a>();
<a name="l00340"></a>00340               <span class="keywordflow">for</span> (i = st.<a class="code" href="classjava__cup_1_1lalr__state.html#a79f7c20c7a43b52f36dfd4531c824732">items</a>().<a class="code" href="classjava__cup_1_1lalr__item__set.html#ab276bc588c75f4f22e46baf01bbcd0b7">all</a>(); i.hasMoreElements();)
<a name="l00341"></a>00341                 {
<a name="l00342"></a>00342                   itm = (<a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a>)i.nextElement();
<a name="l00343"></a>00343 
<a name="l00344"></a>00344                   <span class="comment">/* if this is the symbol we are working on now, add to set */</span>
<a name="l00345"></a>00345                   sym2 = itm.<a class="code" href="classjava__cup_1_1lr__item__core.html#a46e27ab1d918219e48e9720a834b2393">symbol_after_dot</a>();
<a name="l00346"></a>00346                   <span class="keywordflow">if</span> (sym.equals(sym2))
<a name="l00347"></a>00347                     {
<a name="l00348"></a>00348                       <span class="comment">/* add to the kernel of the new state */</span>
<a name="l00349"></a>00349                       new_items.<a class="code" href="classjava__cup_1_1lalr__item__set.html#a9da97681085e4ce96f31a2dce50b987d">add</a>(itm.<a class="code" href="classjava__cup_1_1lalr__item.html#a4211c002ceb104d256e4cf6b14091fd3">shift</a>());
<a name="l00350"></a>00350 
<a name="l00351"></a>00351                       <span class="comment">/* remember that itm has propagate link to it */</span>
<a name="l00352"></a>00352                       linked_items.<a class="code" href="classjava__cup_1_1lalr__item__set.html#a9da97681085e4ce96f31a2dce50b987d">add</a>(itm);
<a name="l00353"></a>00353                     }
<a name="l00354"></a>00354                 }
<a name="l00355"></a>00355 
<a name="l00356"></a>00356               <span class="comment">/* use new items as state kernel */</span>
<a name="l00357"></a>00357               kernel = <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1lalr__item__set.html">lalr_item_set</a>(new_items);
<a name="l00358"></a>00358 
<a name="l00359"></a>00359               <span class="comment">/* have we seen this one already? */</span>
<a name="l00360"></a>00360               new_st = (<a class="code" href="classjava__cup_1_1lalr__state.html#add09dab23ebc0e40de79febe653cc7b4">lalr_state</a>)<a class="code" href="classjava__cup_1_1lalr__state.html#aa9df91fa0bfd008b07cbfc004a88296d">_all_kernels</a>.get(kernel);
<a name="l00361"></a>00361 
<a name="l00362"></a>00362               <span class="comment">/* if we haven&#39;t, build a new state out of the item set */</span>
<a name="l00363"></a>00363               <span class="keywordflow">if</span> (new_st == null)
<a name="l00364"></a>00364                 {
<a name="l00365"></a>00365                   <span class="comment">/* compute closure of the kernel for the full item set */</span>
<a name="l00366"></a>00366                   new_items.<a class="code" href="classjava__cup_1_1lalr__item__set.html#a9e30f462eb3299ee022fe5c9ff01ef71">compute_closure</a>();
<a name="l00367"></a>00367 
<a name="l00368"></a>00368                   <span class="comment">/* build the new state */</span>
<a name="l00369"></a>00369                   new_st = <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1lalr__state.html#add09dab23ebc0e40de79febe653cc7b4">lalr_state</a>(new_items);
<a name="l00370"></a>00370 
<a name="l00371"></a>00371                   <span class="comment">/* add the new state to our work set */</span>
<a name="l00372"></a>00372                   work_stack.push(new_st);
<a name="l00373"></a>00373 
<a name="l00374"></a>00374                   <span class="comment">/* put it in our kernel table */</span>
<a name="l00375"></a>00375                   <a class="code" href="classjava__cup_1_1lalr__state.html#aa9df91fa0bfd008b07cbfc004a88296d">_all_kernels</a>.put(kernel, new_st);
<a name="l00376"></a>00376                 }
<a name="l00377"></a>00377               <span class="comment">/* otherwise relink propagation to items in existing state */</span>
<a name="l00378"></a>00378               <span class="keywordflow">else</span> 
<a name="l00379"></a>00379                 {
<a name="l00380"></a>00380                   <span class="comment">/* walk through the items that have links to the new state */</span>
<a name="l00381"></a>00381                   <span class="keywordflow">for</span> (fix = linked_items.<a class="code" href="classjava__cup_1_1lalr__item__set.html#ab276bc588c75f4f22e46baf01bbcd0b7">all</a>(); fix.hasMoreElements(); )
<a name="l00382"></a>00382                     {
<a name="l00383"></a>00383                       fix_itm = (<a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a>)fix.nextElement();
<a name="l00384"></a>00384 
<a name="l00385"></a>00385                       <span class="comment">/* look at each propagate link out of that item */</span>
<a name="l00386"></a>00386                       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l =0; l &lt; fix_itm.<a class="code" href="classjava__cup_1_1lalr__item.html#ae70bd0190a2dc2b2923f101ef393db81">propagate_items</a>().size(); l++)
<a name="l00387"></a>00387                         {
<a name="l00388"></a>00388                           <span class="comment">/* pull out item linked to in the new state */</span>
<a name="l00389"></a>00389                           new_itm = 
<a name="l00390"></a>00390                             (<a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a>)fix_itm.<a class="code" href="classjava__cup_1_1lalr__item.html#ae70bd0190a2dc2b2923f101ef393db81">propagate_items</a>().elementAt(l);
<a name="l00391"></a>00391 
<a name="l00392"></a>00392                           <span class="comment">/* find corresponding item in the existing state */</span>
<a name="l00393"></a>00393                           existing = new_st.<a class="code" href="classjava__cup_1_1lalr__state.html#a79f7c20c7a43b52f36dfd4531c824732">items</a>().<a class="code" href="classjava__cup_1_1lalr__item__set.html#ae8e56b4e547e8f5d66f26918be071184">find</a>(new_itm);
<a name="l00394"></a>00394 
<a name="l00395"></a>00395                           <span class="comment">/* fix up the item so it points to the existing set */</span>
<a name="l00396"></a>00396                           <span class="keywordflow">if</span> (existing != null)
<a name="l00397"></a>00397                             fix_itm.<a class="code" href="classjava__cup_1_1lalr__item.html#ae70bd0190a2dc2b2923f101ef393db81">propagate_items</a>().setElementAt(existing ,l);
<a name="l00398"></a>00398                         }
<a name="l00399"></a>00399                     }
<a name="l00400"></a>00400                 }
<a name="l00401"></a>00401 
<a name="l00402"></a>00402               <span class="comment">/* add a transition from current state to that state */</span>
<a name="l00403"></a>00403               st.<a class="code" href="classjava__cup_1_1lalr__state.html#aaccbf90f93da595e05ff7da4ebc4c4ce">add_transition</a>(sym, new_st);
<a name="l00404"></a>00404             }
<a name="l00405"></a>00405         }
<a name="l00406"></a>00406 
<a name="l00407"></a>00407       <span class="comment">/* all done building states */</span>
<a name="l00408"></a>00408 
<a name="l00409"></a>00409       <span class="comment">/* propagate complete lookahead sets throughout the states */</span>
<a name="l00410"></a>00410       <a class="code" href="classjava__cup_1_1lalr__state.html#a1392280a8e0cbafed1a2998d07ee5712">propagate_all_lookaheads</a>();
<a name="l00411"></a>00411 
<a name="l00412"></a>00412       <span class="keywordflow">return</span> start_state;
<a name="l00413"></a>00413     }
<a name="l00414"></a>00414 
<a name="l00415"></a>00415   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00416"></a>00416 
<a name="l00421"></a><a class="code" href="classjava__cup_1_1lalr__state.html#a62f863be0ab72998e795368d548187bc">00421</a>   <span class="keyword">protected</span> <span class="keywordtype">void</span> <a class="code" href="classjava__cup_1_1lalr__state.html#a62f863be0ab72998e795368d548187bc">propagate_lookaheads</a>() throws <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>
<a name="l00422"></a>00422     {
<a name="l00423"></a>00423       <span class="comment">/* recursively propagate out from each item in the state */</span>
<a name="l00424"></a>00424       <span class="keywordflow">for</span> (Enumeration itm = <a class="code" href="classjava__cup_1_1lalr__state.html#a79f7c20c7a43b52f36dfd4531c824732">items</a>().<a class="code" href="classjava__cup_1_1lalr__state.html#a1fbb9402cedc4be04f3900f34fb41c35">all</a>(); itm.hasMoreElements(); )
<a name="l00425"></a>00425         ((<a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a>)itm.nextElement()).<a class="code" href="classjava__cup_1_1lalr__state.html#a62f863be0ab72998e795368d548187bc">propagate_lookaheads</a>(null);
<a name="l00426"></a>00426     }
<a name="l00427"></a>00427 
<a name="l00428"></a>00428   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00429"></a>00429 
<a name="l00451"></a><a class="code" href="classjava__cup_1_1lalr__state.html#abb1ba0becc5c57c487adac88c1dee36b">00451</a>   <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classjava__cup_1_1lalr__state.html#abb1ba0becc5c57c487adac88c1dee36b">build_table_entries</a>(
<a name="l00452"></a>00452     <a class="code" href="classjava__cup_1_1parse__action__table.html">parse_action_table</a> act_table, 
<a name="l00453"></a>00453     <a class="code" href="classjava__cup_1_1parse__reduce__table.html">parse_reduce_table</a> reduce_table)
<a name="l00454"></a>00454     <span class="keywordflow">throws</span> <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>
<a name="l00455"></a>00455     {
<a name="l00456"></a>00456       <a class="code" href="classjava__cup_1_1parse__action__row.html">parse_action_row</a> our_act_row;
<a name="l00457"></a>00457       <a class="code" href="classjava__cup_1_1parse__reduce__row.html">parse_reduce_row</a> our_red_row;
<a name="l00458"></a>00458       <a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a>        itm;
<a name="l00459"></a>00459       <a class="code" href="classjava__cup_1_1parse__action.html">parse_action</a>     act, other_act;
<a name="l00460"></a>00460       <a class="code" href="classjava__cup_1_1symbol.html">symbol</a>           <a class="code" href="classjava__cup_1_1sym.html">sym</a>;
<a name="l00461"></a>00461       <a class="code" href="classjava__cup_1_1terminal__set.html">terminal_set</a>     conflict_set = <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1terminal__set.html">terminal_set</a>();
<a name="l00462"></a>00462 
<a name="l00463"></a>00463       <span class="comment">/* pull out our rows from the tables */</span>
<a name="l00464"></a>00464       our_act_row = act_table.under_state[<a class="code" href="classjava__cup_1_1lalr__state.html#a4739bfae64234f684f099013d301522c">index</a>()];
<a name="l00465"></a>00465       our_red_row = reduce_table.under_state[<a class="code" href="classjava__cup_1_1lalr__state.html#a4739bfae64234f684f099013d301522c">index</a>()];
<a name="l00466"></a>00466 
<a name="l00467"></a>00467       <span class="comment">/* consider each item in our state */</span>
<a name="l00468"></a>00468       <span class="keywordflow">for</span> (Enumeration i = <a class="code" href="classjava__cup_1_1lalr__state.html#a79f7c20c7a43b52f36dfd4531c824732">items</a>().<a class="code" href="classjava__cup_1_1lalr__state.html#a1fbb9402cedc4be04f3900f34fb41c35">all</a>(); i.hasMoreElements(); )
<a name="l00469"></a>00469         {
<a name="l00470"></a>00470           itm = (<a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a>)i.nextElement();
<a name="l00471"></a>00471          
<a name="l00472"></a>00472 
<a name="l00473"></a>00473           <span class="comment">/* if its completed (dot at end) then reduce under the lookahead */</span>
<a name="l00474"></a>00474           <span class="keywordflow">if</span> (itm.<a class="code" href="classjava__cup_1_1lr__item__core.html#ae3056b0c70648240cc9682f2af398d45">dot_at_end</a>())
<a name="l00475"></a>00475             {
<a name="l00476"></a>00476               act = <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1reduce__action.html">reduce_action</a>(itm.<a class="code" href="classjava__cup_1_1lr__item__core.html#a9204bcb89701764f202ad5bc158aeb38">the_production</a>());
<a name="l00477"></a>00477 
<a name="l00478"></a>00478               <span class="comment">/* consider each lookahead symbol */</span>
<a name="l00479"></a>00479               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t = 0; t &lt; <a class="code" href="classjava__cup_1_1terminal.html">terminal</a>.<a class="code" href="classjava__cup_1_1terminal.html#a01a022956c88b37b14e1dcb444693ab2">number</a>(); t++)
<a name="l00480"></a>00480                 {
<a name="l00481"></a>00481                   <span class="comment">/* skip over the ones not in the lookahead */</span>
<a name="l00482"></a>00482                   <span class="keywordflow">if</span> (!itm.<a class="code" href="classjava__cup_1_1lalr__item.html#a7deb179749d6f1cd97987f1aa6007ec1">lookahead</a>().<a class="code" href="classjava__cup_1_1terminal__set.html#a13020cba011e6670290d2946c826db88">contains</a>(t)) <span class="keywordflow">continue</span>;
<a name="l00483"></a>00483 
<a name="l00484"></a>00484                   <span class="comment">/* if we don&#39;t already have an action put this one in */</span>
<a name="l00485"></a>00485                   <span class="keywordflow">if</span> (our_act_row.<a class="code" href="classjava__cup_1_1parse__action__row.html#aff77eb30bc2be7dea0133812ed665e61">under_term</a>[t].<a class="code" href="classjava__cup_1_1parse__action.html#ac0878ca74fc240cf0b8b99973c59b4d5">kind</a>() == 
<a name="l00486"></a>00486                       <a class="code" href="classjava__cup_1_1parse__action.html">parse_action</a>.<a class="code" href="classjava__cup_1_1parse__action.html#a52fea1381bb54b4eb379c6ea3398a137">ERROR</a>)
<a name="l00487"></a>00487                     {
<a name="l00488"></a>00488                       our_act_row.<a class="code" href="classjava__cup_1_1parse__action__row.html#aff77eb30bc2be7dea0133812ed665e61">under_term</a>[t] = act;
<a name="l00489"></a>00489                     }
<a name="l00490"></a>00490                   <span class="keywordflow">else</span>
<a name="l00491"></a>00491                     {
<a name="l00492"></a>00492                       <span class="comment">/* we now have at least one conflict */</span>
<a name="l00493"></a>00493                       <a class="code" href="classjava__cup_1_1terminal.html">terminal</a> term = <a class="code" href="classjava__cup_1_1terminal.html">terminal</a>.<a class="code" href="classjava__cup_1_1terminal.html#a22386de6f7027943b8bb5cacdabd9749">find</a>(t);
<a name="l00494"></a>00494                       other_act = our_act_row.<a class="code" href="classjava__cup_1_1parse__action__row.html#aff77eb30bc2be7dea0133812ed665e61">under_term</a>[t];
<a name="l00495"></a>00495 
<a name="l00496"></a>00496                       <span class="comment">/* if the other act was not a shift */</span>
<a name="l00497"></a>00497                       <span class="keywordflow">if</span> ((other_act.<a class="code" href="classjava__cup_1_1parse__action.html#ac0878ca74fc240cf0b8b99973c59b4d5">kind</a>() != <a class="code" href="classjava__cup_1_1parse__action.html">parse_action</a>.<a class="code" href="classjava__cup_1_1parse__action.html#aa2bada047360dfd969086dd151a5a969">SHIFT</a>) &amp;&amp; 
<a name="l00498"></a>00498                           (other_act.<a class="code" href="classjava__cup_1_1parse__action.html#ac0878ca74fc240cf0b8b99973c59b4d5">kind</a>() != <a class="code" href="classjava__cup_1_1parse__action.html">parse_action</a>.<a class="code" href="classjava__cup_1_1parse__action.html#aab93c6c4eca5cd90a5faa8759cdccc81">NONASSOC</a>))
<a name="l00499"></a>00499                         {
<a name="l00500"></a>00500                         <span class="comment">/* if we have lower index hence priority, replace it*/</span>
<a name="l00501"></a>00501                           <span class="keywordflow">if</span> (itm.<a class="code" href="classjava__cup_1_1lr__item__core.html#a9204bcb89701764f202ad5bc158aeb38">the_production</a>().<a class="code" href="classjava__cup_1_1production.html#aeca007bc3659e5ca9236f5ffea8a8e07">index</a>() &lt; 
<a name="l00502"></a>00502                               ((<a class="code" href="classjava__cup_1_1reduce__action.html">reduce_action</a>)other_act).reduce_with().index())
<a name="l00503"></a>00503                             {
<a name="l00504"></a>00504                               <span class="comment">/* replace the action */</span>
<a name="l00505"></a>00505                               our_act_row.<a class="code" href="classjava__cup_1_1parse__action__row.html#aff77eb30bc2be7dea0133812ed665e61">under_term</a>[t] = act;
<a name="l00506"></a>00506                             }
<a name="l00507"></a>00507                         } <span class="keywordflow">else</span> {
<a name="l00508"></a>00508                           <span class="comment">/*  Check precedences,see if problem is correctable */</span>
<a name="l00509"></a>00509                           <span class="keywordflow">if</span>(<a class="code" href="classjava__cup_1_1lalr__state.html#a7b51c8281a4d962d37147c581da97b8c">fix_with_precedence</a>(itm.<a class="code" href="classjava__cup_1_1lr__item__core.html#a9204bcb89701764f202ad5bc158aeb38">the_production</a>(), 
<a name="l00510"></a>00510                                                  t, our_act_row, act)) {
<a name="l00511"></a>00511                             term = null;
<a name="l00512"></a>00512                           }
<a name="l00513"></a>00513                         }
<a name="l00514"></a>00514                       <span class="keywordflow">if</span>(term!=null) {
<a name="l00515"></a>00515 
<a name="l00516"></a>00516                         conflict_set.<a class="code" href="classjava__cup_1_1terminal__set.html#a073ab4492e122cfa6eb75e729b81db78">add</a>(term);
<a name="l00517"></a>00517                       }
<a name="l00518"></a>00518                     }
<a name="l00519"></a>00519                 }
<a name="l00520"></a>00520             }
<a name="l00521"></a>00521         }
<a name="l00522"></a>00522 
<a name="l00523"></a>00523       <span class="comment">/* consider each outgoing transition */</span>
<a name="l00524"></a>00524       <span class="keywordflow">for</span> (<a class="code" href="classjava__cup_1_1lalr__transition.html">lalr_transition</a> trans=<a class="code" href="classjava__cup_1_1lalr__state.html#ad3c1f8e5f82060f48717a8a4a7561fc1">transitions</a>(); trans!=null; trans=trans.<a class="code" href="classjava__cup_1_1lalr__transition.html#a7ec6a2cca99b57a9d0e53ed2cca9028e">next</a>())
<a name="l00525"></a>00525         {
<a name="l00526"></a>00526           <span class="comment">/* if its on an terminal add a shift entry */</span>
<a name="l00527"></a>00527           sym = trans.on_symbol();
<a name="l00528"></a>00528           <span class="keywordflow">if</span> (!sym.<a class="code" href="classjava__cup_1_1symbol.html#af17ee2183b92a3fa0946ad0fd75eb0f8">is_non_term</a>())
<a name="l00529"></a>00529             {
<a name="l00530"></a>00530               act = <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1shift__action.html">shift_action</a>(trans.to_state());
<a name="l00531"></a>00531 
<a name="l00532"></a>00532               <span class="comment">/* if we don&#39;t already have an action put this one in */</span>
<a name="l00533"></a>00533               <span class="keywordflow">if</span> ( our_act_row.<a class="code" href="classjava__cup_1_1parse__action__row.html#aff77eb30bc2be7dea0133812ed665e61">under_term</a>[sym.<a class="code" href="classjava__cup_1_1symbol.html#a427ae231940ae6b99d6b8983a16e18f8">index</a>()].<a class="code" href="classjava__cup_1_1parse__action.html#ac0878ca74fc240cf0b8b99973c59b4d5">kind</a>() == 
<a name="l00534"></a>00534                    <a class="code" href="classjava__cup_1_1parse__action.html">parse_action</a>.<a class="code" href="classjava__cup_1_1parse__action.html#a52fea1381bb54b4eb379c6ea3398a137">ERROR</a>)
<a name="l00535"></a>00535                 {
<a name="l00536"></a>00536                   our_act_row.<a class="code" href="classjava__cup_1_1parse__action__row.html#aff77eb30bc2be7dea0133812ed665e61">under_term</a>[sym.<a class="code" href="classjava__cup_1_1symbol.html#a427ae231940ae6b99d6b8983a16e18f8">index</a>()] = act;
<a name="l00537"></a>00537                 }
<a name="l00538"></a>00538               <span class="keywordflow">else</span>
<a name="l00539"></a>00539                 {
<a name="l00540"></a>00540                   <span class="comment">/* we now have at least one conflict */</span>
<a name="l00541"></a>00541                   <a class="code" href="classjava__cup_1_1production.html">production</a> p = ((<a class="code" href="classjava__cup_1_1reduce__action.html">reduce_action</a>)our_act_row.<a class="code" href="classjava__cup_1_1parse__action__row.html#aff77eb30bc2be7dea0133812ed665e61">under_term</a>[sym.<a class="code" href="classjava__cup_1_1symbol.html#a427ae231940ae6b99d6b8983a16e18f8">index</a>()]).reduce_with();
<a name="l00542"></a>00542 
<a name="l00543"></a>00543                   <span class="comment">/* shift always wins */</span>
<a name="l00544"></a>00544                   <span class="keywordflow">if</span> (!<a class="code" href="classjava__cup_1_1lalr__state.html#a7b51c8281a4d962d37147c581da97b8c">fix_with_precedence</a>(p, sym.<a class="code" href="classjava__cup_1_1symbol.html#a427ae231940ae6b99d6b8983a16e18f8">index</a>(), our_act_row, act)) {
<a name="l00545"></a>00545                     our_act_row.<a class="code" href="classjava__cup_1_1parse__action__row.html#aff77eb30bc2be7dea0133812ed665e61">under_term</a>[sym.<a class="code" href="classjava__cup_1_1symbol.html#a427ae231940ae6b99d6b8983a16e18f8">index</a>()] = act;
<a name="l00546"></a>00546                     conflict_set.<a class="code" href="classjava__cup_1_1terminal__set.html#a073ab4492e122cfa6eb75e729b81db78">add</a>(<a class="code" href="classjava__cup_1_1terminal.html">terminal</a>.<a class="code" href="classjava__cup_1_1terminal.html#a22386de6f7027943b8bb5cacdabd9749">find</a>(sym.<a class="code" href="classjava__cup_1_1symbol.html#a427ae231940ae6b99d6b8983a16e18f8">index</a>()));
<a name="l00547"></a>00547                   }
<a name="l00548"></a>00548                 }
<a name="l00549"></a>00549             }
<a name="l00550"></a>00550           <span class="keywordflow">else</span>
<a name="l00551"></a>00551             {
<a name="l00552"></a>00552               <span class="comment">/* for non terminals add an entry to the reduce-goto table */</span>
<a name="l00553"></a>00553               our_red_row.<a class="code" href="classjava__cup_1_1parse__reduce__row.html#afd1ac7a2ed990498894d85f8a4901ec6">under_non_term</a>[sym.<a class="code" href="classjava__cup_1_1symbol.html#a427ae231940ae6b99d6b8983a16e18f8">index</a>()] = trans.to_state();
<a name="l00554"></a>00554             }
<a name="l00555"></a>00555         }
<a name="l00556"></a>00556 
<a name="l00557"></a>00557       <span class="comment">/* if we end up with conflict(s), report them */</span>
<a name="l00558"></a>00558       <span class="keywordflow">if</span> (!conflict_set.<a class="code" href="classjava__cup_1_1terminal__set.html#a1bb6eed2dc30a79c1f9f1ea7c968d061">empty</a>())
<a name="l00559"></a>00559         <a class="code" href="classjava__cup_1_1lalr__state.html#ade8070be96c38cce3ce124db4ff3b530">report_conflicts</a>(conflict_set);
<a name="l00560"></a>00560     }
<a name="l00561"></a>00561 
<a name="l00562"></a>00562   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00563"></a>00563 
<a name="l00564"></a>00564     
<a name="l00584"></a><a class="code" href="classjava__cup_1_1lalr__state.html#a7b51c8281a4d962d37147c581da97b8c">00584</a>     <span class="keyword">protected</span> <span class="keywordtype">boolean</span> <a class="code" href="classjava__cup_1_1lalr__state.html#a7b51c8281a4d962d37147c581da97b8c">fix_with_precedence</a>(
<a name="l00585"></a>00585                         <a class="code" href="classjava__cup_1_1production.html">production</a>       p,
<a name="l00586"></a>00586                         <span class="keywordtype">int</span>              term_index,
<a name="l00587"></a>00587                         <a class="code" href="classjava__cup_1_1parse__action__row.html">parse_action_row</a> table_row,
<a name="l00588"></a>00588                         <a class="code" href="classjava__cup_1_1parse__action.html">parse_action</a>     act)
<a name="l00589"></a>00589 
<a name="l00590"></a>00590       <span class="keywordflow">throws</span> <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a> {
<a name="l00591"></a>00591 
<a name="l00592"></a>00592       <a class="code" href="classjava__cup_1_1terminal.html">terminal</a> term = <a class="code" href="classjava__cup_1_1terminal.html">terminal</a>.<a class="code" href="classjava__cup_1_1terminal.html#a22386de6f7027943b8bb5cacdabd9749">find</a>(term_index);
<a name="l00593"></a>00593 
<a name="l00594"></a>00594       <span class="comment">/* if the production has a precedence number, it can be fixed */</span>
<a name="l00595"></a>00595       <span class="keywordflow">if</span> (p.precedence_num() &gt; <a class="code" href="classjava__cup_1_1assoc.html">assoc</a>.<a class="code" href="classjava__cup_1_1assoc.html#a2b1b3a273cd870cf5c857acc6127d890">no_prec</a>) {
<a name="l00596"></a>00596 
<a name="l00597"></a>00597         <span class="comment">/* if production precedes terminal, put reduce in table */</span>
<a name="l00598"></a>00598         <span class="keywordflow">if</span> (p.precedence_num() &gt; term.<a class="code" href="classjava__cup_1_1terminal.html#ac5151c9af12bba5540d23aed904e1ec1">precedence_num</a>()) {
<a name="l00599"></a>00599           table_row.under_term[term_index] = 
<a name="l00600"></a>00600             <a class="code" href="classjava__cup_1_1lalr__state.html#af56a09f340e78e4bb1ee8cfc01a82cd5">insert_reduce</a>(table_row.under_term[term_index],act);
<a name="l00601"></a>00601           <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00602"></a>00602         } 
<a name="l00603"></a>00603 
<a name="l00604"></a>00604         <span class="comment">/* if terminal precedes rule, put shift in table */</span>
<a name="l00605"></a>00605         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p.precedence_num() &lt; term.<a class="code" href="classjava__cup_1_1terminal.html#ac5151c9af12bba5540d23aed904e1ec1">precedence_num</a>()) {
<a name="l00606"></a>00606           table_row.under_term[term_index] = 
<a name="l00607"></a>00607             <a class="code" href="classjava__cup_1_1lalr__state.html#ad5a9186cf00c5cf5536b007e8d4ee8ea">insert_shift</a>(table_row.under_term[term_index],act);
<a name="l00608"></a>00608           <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00609"></a>00609         } 
<a name="l00610"></a>00610         <span class="keywordflow">else</span> {  <span class="comment">/* they are == precedence */</span>
<a name="l00611"></a>00611 
<a name="l00612"></a>00612           <span class="comment">/* equal precedences have equal sides, so only need to </span>
<a name="l00613"></a>00613 <span class="comment">             look at one: if it is right, put shift in table */</span>
<a name="l00614"></a>00614           <span class="keywordflow">if</span> (term.<a class="code" href="classjava__cup_1_1terminal.html#a0b078bb1d356353246a2151420862242">precedence_side</a>() == <a class="code" href="classjava__cup_1_1assoc.html">assoc</a>.<a class="code" href="classjava__cup_1_1assoc.html#a28c1e048217dedfe876c9703ce3ae3f1">right</a>) {
<a name="l00615"></a>00615           table_row.under_term[term_index] = 
<a name="l00616"></a>00616             <a class="code" href="classjava__cup_1_1lalr__state.html#ad5a9186cf00c5cf5536b007e8d4ee8ea">insert_shift</a>(table_row.under_term[term_index],act);
<a name="l00617"></a>00617             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00618"></a>00618           }
<a name="l00619"></a>00619 
<a name="l00620"></a>00620           <span class="comment">/* if it is left, put reduce in table */</span>
<a name="l00621"></a>00621           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (term.<a class="code" href="classjava__cup_1_1terminal.html#a0b078bb1d356353246a2151420862242">precedence_side</a>() == <a class="code" href="classjava__cup_1_1assoc.html">assoc</a>.<a class="code" href="classjava__cup_1_1assoc.html#a8ab4bbadd010a7cb7d7b91503ea812e6">left</a>) {
<a name="l00622"></a>00622             table_row.under_term[term_index] = 
<a name="l00623"></a>00623               <a class="code" href="classjava__cup_1_1lalr__state.html#af56a09f340e78e4bb1ee8cfc01a82cd5">insert_reduce</a>(table_row.under_term[term_index],act);
<a name="l00624"></a>00624             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00625"></a>00625           }
<a name="l00626"></a>00626 
<a name="l00627"></a>00627           <span class="comment">/* if it is nonassoc, we&#39;re not allowed to have two nonassocs</span>
<a name="l00628"></a>00628 <span class="comment">             of equal precedence in a row, so put in NONASSOC */</span>
<a name="l00629"></a>00629           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (term.<a class="code" href="classjava__cup_1_1terminal.html#a0b078bb1d356353246a2151420862242">precedence_side</a>() == <a class="code" href="classjava__cup_1_1assoc.html">assoc</a>.<a class="code" href="classjava__cup_1_1assoc.html#adb240c8c45abc6712af48113e151563b">nonassoc</a>) {
<a name="l00630"></a>00630             table_row.under_term[term_index] = <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1nonassoc__action.html">nonassoc_action</a>();
<a name="l00631"></a>00631             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00632"></a>00632           } <span class="keywordflow">else</span> {
<a name="l00633"></a>00633             <span class="comment">/* something really went wrong */</span>
<a name="l00634"></a>00634             <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>(<span class="stringliteral">&quot;Unable to resolve conflict correctly&quot;</span>);
<a name="l00635"></a>00635           }
<a name="l00636"></a>00636         }
<a name="l00637"></a>00637       }
<a name="l00638"></a>00638       <span class="comment">/* check if terminal has precedence, if so, shift, since </span>
<a name="l00639"></a>00639 <span class="comment">         rule does not have precedence */</span>
<a name="l00640"></a>00640       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (term.<a class="code" href="classjava__cup_1_1terminal.html#ac5151c9af12bba5540d23aed904e1ec1">precedence_num</a>() &gt; <a class="code" href="classjava__cup_1_1assoc.html">assoc</a>.<a class="code" href="classjava__cup_1_1assoc.html#a2b1b3a273cd870cf5c857acc6127d890">no_prec</a>) {
<a name="l00641"></a>00641          table_row.under_term[term_index] = 
<a name="l00642"></a>00642            <a class="code" href="classjava__cup_1_1lalr__state.html#ad5a9186cf00c5cf5536b007e8d4ee8ea">insert_shift</a>(table_row.under_term[term_index],act);
<a name="l00643"></a>00643          <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00644"></a>00644       }
<a name="l00645"></a>00645        
<a name="l00646"></a>00646       <span class="comment">/* otherwise, neither the rule nor the terminal has a precedence,</span>
<a name="l00647"></a>00647 <span class="comment">         so it can&#39;t be fixed. */</span>
<a name="l00648"></a>00648       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00649"></a>00649     }
<a name="l00650"></a>00650 
<a name="l00651"></a>00651   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00652"></a>00652 
<a name="l00653"></a>00653 
<a name="l00654"></a>00654   <span class="comment">/*  given two actions, and an action type, return the </span>
<a name="l00655"></a>00655 <span class="comment">      action of that action type.  give an error if they are of</span>
<a name="l00656"></a>00656 <span class="comment">      the same action, because that should never have tried</span>
<a name="l00657"></a>00657 <span class="comment">      to be fixed </span>
<a name="l00658"></a>00658 <span class="comment">     </span>
<a name="l00659"></a>00659 <span class="comment">  */</span>
<a name="l00660"></a><a class="code" href="classjava__cup_1_1lalr__state.html#ae72ee3f18ebf250811eb2c964b35fbb4">00660</a>     <span class="keyword">protected</span> <a class="code" href="classjava__cup_1_1parse__action.html">parse_action</a> <a class="code" href="classjava__cup_1_1lalr__state.html#ae72ee3f18ebf250811eb2c964b35fbb4">insert_action</a>(
<a name="l00661"></a>00661                                         <a class="code" href="classjava__cup_1_1parse__action.html">parse_action</a> a1,
<a name="l00662"></a>00662                                         <a class="code" href="classjava__cup_1_1parse__action.html">parse_action</a> a2,
<a name="l00663"></a>00663                                         <span class="keywordtype">int</span> act_type) 
<a name="l00664"></a>00664       <span class="keywordflow">throws</span> <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>
<a name="l00665"></a>00665     {
<a name="l00666"></a>00666       <span class="keywordflow">if</span> ((a1.kind() == act_type) &amp;&amp; (a2.kind() == act_type)) {
<a name="l00667"></a>00667         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>(<span class="stringliteral">&quot;Conflict resolution of bogus actions&quot;</span>);
<a name="l00668"></a>00668       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a1.kind() == act_type) {
<a name="l00669"></a>00669         <span class="keywordflow">return</span> a1;
<a name="l00670"></a>00670       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a2.kind() == act_type) {
<a name="l00671"></a>00671         <span class="keywordflow">return</span> a2;
<a name="l00672"></a>00672       } <span class="keywordflow">else</span> {
<a name="l00673"></a>00673         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>(<span class="stringliteral">&quot;Conflict resolution of bogus actions&quot;</span>);
<a name="l00674"></a>00674       }
<a name="l00675"></a>00675     }
<a name="l00676"></a>00676 
<a name="l00677"></a>00677     <span class="comment">/* find the shift in the two actions */</span>
<a name="l00678"></a><a class="code" href="classjava__cup_1_1lalr__state.html#ad5a9186cf00c5cf5536b007e8d4ee8ea">00678</a>     <span class="keyword">protected</span> <a class="code" href="classjava__cup_1_1parse__action.html">parse_action</a> <a class="code" href="classjava__cup_1_1lalr__state.html#ad5a9186cf00c5cf5536b007e8d4ee8ea">insert_shift</a>(
<a name="l00679"></a>00679                                         <a class="code" href="classjava__cup_1_1parse__action.html">parse_action</a> a1,
<a name="l00680"></a>00680                                         <a class="code" href="classjava__cup_1_1parse__action.html">parse_action</a> a2) 
<a name="l00681"></a>00681       <span class="keywordflow">throws</span> <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>  
<a name="l00682"></a>00682     {
<a name="l00683"></a>00683       <span class="keywordflow">return</span> <a class="code" href="classjava__cup_1_1lalr__state.html#ae72ee3f18ebf250811eb2c964b35fbb4">insert_action</a>(a1, a2, <a class="code" href="classjava__cup_1_1parse__action.html">parse_action</a>.<a class="code" href="classjava__cup_1_1parse__action.html#aa2bada047360dfd969086dd151a5a969">SHIFT</a>);
<a name="l00684"></a>00684     }
<a name="l00685"></a>00685 
<a name="l00686"></a>00686     <span class="comment">/* find the reduce in the two actions */</span>
<a name="l00687"></a><a class="code" href="classjava__cup_1_1lalr__state.html#af56a09f340e78e4bb1ee8cfc01a82cd5">00687</a>     <span class="keyword">protected</span> <a class="code" href="classjava__cup_1_1parse__action.html">parse_action</a> <a class="code" href="classjava__cup_1_1lalr__state.html#af56a09f340e78e4bb1ee8cfc01a82cd5">insert_reduce</a>(
<a name="l00688"></a>00688                                         <a class="code" href="classjava__cup_1_1parse__action.html">parse_action</a> a1,
<a name="l00689"></a>00689                                         <a class="code" href="classjava__cup_1_1parse__action.html">parse_action</a> a2) 
<a name="l00690"></a>00690       <span class="keywordflow">throws</span> <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>
<a name="l00691"></a>00691     {
<a name="l00692"></a>00692       <span class="keywordflow">return</span> <a class="code" href="classjava__cup_1_1lalr__state.html#ae72ee3f18ebf250811eb2c964b35fbb4">insert_action</a>(a1, a2, <a class="code" href="classjava__cup_1_1parse__action.html">parse_action</a>.<a class="code" href="classjava__cup_1_1parse__action.html#a449fa9bc5956192891bec6979133c0e9">REDUCE</a>);
<a name="l00693"></a>00693     }
<a name="l00694"></a>00694 
<a name="l00695"></a>00695   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00696"></a>00696 
<a name="l00698"></a><a class="code" href="classjava__cup_1_1lalr__state.html#ade8070be96c38cce3ce124db4ff3b530">00698</a>   <span class="keyword">protected</span> <span class="keywordtype">void</span> <a class="code" href="classjava__cup_1_1lalr__state.html#ade8070be96c38cce3ce124db4ff3b530">report_conflicts</a>(<a class="code" href="classjava__cup_1_1terminal__set.html">terminal_set</a> conflict_set)
<a name="l00699"></a>00699     <span class="keywordflow">throws</span> <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>
<a name="l00700"></a>00700     {
<a name="l00701"></a>00701       <a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a>    itm, compare;
<a name="l00702"></a>00702       <a class="code" href="classjava__cup_1_1symbol.html">symbol</a>       shift_sym;
<a name="l00703"></a>00703 
<a name="l00704"></a>00704       <span class="keywordtype">boolean</span>      after_itm;
<a name="l00705"></a>00705 
<a name="l00706"></a>00706       <span class="comment">/* consider each element */</span>
<a name="l00707"></a>00707       <span class="keywordflow">for</span> (Enumeration itms = <a class="code" href="classjava__cup_1_1lalr__state.html#a79f7c20c7a43b52f36dfd4531c824732">items</a>().<a class="code" href="classjava__cup_1_1lalr__state.html#a1fbb9402cedc4be04f3900f34fb41c35">all</a>(); itms.hasMoreElements(); )
<a name="l00708"></a>00708         {
<a name="l00709"></a>00709           itm = (<a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a>)itms.nextElement();
<a name="l00710"></a>00710 
<a name="l00711"></a>00711           <span class="comment">/* clear the S/R conflict set for this item */</span>
<a name="l00712"></a>00712 
<a name="l00713"></a>00713           <span class="comment">/* if it results in a reduce, it could be a conflict */</span>
<a name="l00714"></a>00714           <span class="keywordflow">if</span> (itm.<a class="code" href="classjava__cup_1_1lr__item__core.html#ae3056b0c70648240cc9682f2af398d45">dot_at_end</a>())
<a name="l00715"></a>00715             {
<a name="l00716"></a>00716               <span class="comment">/* not yet after itm */</span>
<a name="l00717"></a>00717               after_itm = <span class="keyword">false</span>;
<a name="l00718"></a>00718 
<a name="l00719"></a>00719               <span class="comment">/* compare this item against all others looking for conflicts */</span>
<a name="l00720"></a>00720               <span class="keywordflow">for</span> (Enumeration comps = <a class="code" href="classjava__cup_1_1lalr__state.html#a79f7c20c7a43b52f36dfd4531c824732">items</a>().<a class="code" href="classjava__cup_1_1lalr__item__set.html#ab276bc588c75f4f22e46baf01bbcd0b7">all</a>(); comps.hasMoreElements(); )
<a name="l00721"></a>00721                 {
<a name="l00722"></a>00722                   compare = (<a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a>)comps.nextElement();
<a name="l00723"></a>00723 
<a name="l00724"></a>00724                   <span class="comment">/* if this is the item, next one is after it */</span>
<a name="l00725"></a>00725                   <span class="keywordflow">if</span> (itm == compare) after_itm = <span class="keyword">true</span>;
<a name="l00726"></a>00726 
<a name="l00727"></a>00727                   <span class="comment">/* only look at it if its not the same item */</span>
<a name="l00728"></a>00728                   <span class="keywordflow">if</span> (itm != compare)
<a name="l00729"></a>00729                     {
<a name="l00730"></a>00730                       <span class="comment">/* is it a reduce */</span>
<a name="l00731"></a>00731                       <span class="keywordflow">if</span> (compare.<a class="code" href="classjava__cup_1_1lr__item__core.html#ae3056b0c70648240cc9682f2af398d45">dot_at_end</a>())
<a name="l00732"></a>00732                         {
<a name="l00733"></a>00733                           <span class="comment">/* only look at reduces after itm */</span>
<a name="l00734"></a>00734                           <span class="keywordflow">if</span> (after_itm)
<a name="l00735"></a>00735                             <span class="comment">/* does the comparison item conflict? */</span>
<a name="l00736"></a>00736                             <span class="keywordflow">if</span> (compare.<a class="code" href="classjava__cup_1_1lalr__item.html#a7deb179749d6f1cd97987f1aa6007ec1">lookahead</a>().<a class="code" href="classjava__cup_1_1terminal__set.html#ad777dcf2a312cfbe35858ddb92a56031">intersects</a>(itm.<a class="code" href="classjava__cup_1_1lalr__item.html#a7deb179749d6f1cd97987f1aa6007ec1">lookahead</a>()))
<a name="l00737"></a>00737                               <span class="comment">/* report a reduce/reduce conflict */</span>
<a name="l00738"></a>00738                               <a class="code" href="classjava__cup_1_1lalr__state.html#ace4616bdd729d7c9bb01f3e16d0aff31">report_reduce_reduce</a>(itm, compare);
<a name="l00739"></a>00739                         }
<a name="l00740"></a>00740                     }
<a name="l00741"></a>00741                 }
<a name="l00742"></a>00742               <span class="comment">/* report S/R conflicts under all the symbols we conflict under */</span>
<a name="l00743"></a>00743               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t = 0; t &lt; <a class="code" href="classjava__cup_1_1terminal.html">terminal</a>.<a class="code" href="classjava__cup_1_1terminal.html#a01a022956c88b37b14e1dcb444693ab2">number</a>(); t++)
<a name="l00744"></a>00744                 <span class="keywordflow">if</span> (conflict_set.contains(t))
<a name="l00745"></a>00745                   <a class="code" href="classjava__cup_1_1lalr__state.html#a9104f87fd9f391195ee6a6c6bc552eab">report_shift_reduce</a>(itm,t);
<a name="l00746"></a>00746             }
<a name="l00747"></a>00747         }
<a name="l00748"></a>00748     }
<a name="l00749"></a>00749 
<a name="l00750"></a>00750   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00751"></a>00751 
<a name="l00757"></a><a class="code" href="classjava__cup_1_1lalr__state.html#ace4616bdd729d7c9bb01f3e16d0aff31">00757</a>   <span class="keyword">protected</span> <span class="keywordtype">void</span> <a class="code" href="classjava__cup_1_1lalr__state.html#ace4616bdd729d7c9bb01f3e16d0aff31">report_reduce_reduce</a>(<a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a> itm1, <a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a> itm2)
<a name="l00758"></a>00758     <span class="keywordflow">throws</span> <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>
<a name="l00759"></a>00759     {
<a name="l00760"></a>00760       <span class="keywordtype">boolean</span> comma_flag = <span class="keyword">false</span>;
<a name="l00761"></a>00761 
<a name="l00762"></a>00762       System.err.println(<span class="stringliteral">&quot;*** Reduce/Reduce conflict found in state #&quot;</span>+<a class="code" href="classjava__cup_1_1lalr__state.html#a4739bfae64234f684f099013d301522c">index</a>());
<a name="l00763"></a>00763       System.err.print  (<span class="stringliteral">&quot;  between &quot;</span>);
<a name="l00764"></a>00764       System.err.println(itm1.to_simple_string());
<a name="l00765"></a>00765       System.err.print  (<span class="stringliteral">&quot;  and     &quot;</span>);
<a name="l00766"></a>00766       System.err.println(itm2.to_simple_string());
<a name="l00767"></a>00767       System.err.print(<span class="stringliteral">&quot;  under symbols: {&quot;</span> );
<a name="l00768"></a>00768       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t = 0; t &lt; <a class="code" href="classjava__cup_1_1terminal.html">terminal</a>.<a class="code" href="classjava__cup_1_1terminal.html#a01a022956c88b37b14e1dcb444693ab2">number</a>(); t++)
<a name="l00769"></a>00769         {
<a name="l00770"></a>00770           <span class="keywordflow">if</span> (itm1.lookahead().contains(t) &amp;&amp; itm2.lookahead().contains(t))
<a name="l00771"></a>00771             {
<a name="l00772"></a>00772               <span class="keywordflow">if</span> (comma_flag) System.err.print(<span class="stringliteral">&quot;, &quot;</span>); <span class="keywordflow">else</span> comma_flag = <span class="keyword">true</span>;
<a name="l00773"></a>00773               System.err.print(<a class="code" href="classjava__cup_1_1terminal.html">terminal</a>.<a class="code" href="classjava__cup_1_1terminal.html#a22386de6f7027943b8bb5cacdabd9749">find</a>(t).<a class="code" href="classjava__cup_1_1symbol.html#a2886f199df09de270d6ee498f7044793">name</a>());
<a name="l00774"></a>00774             }
<a name="l00775"></a>00775         }
<a name="l00776"></a>00776       System.err.println(<span class="stringliteral">&quot;}&quot;</span>);
<a name="l00777"></a>00777       System.err.print(<span class="stringliteral">&quot;  Resolved in favor of &quot;</span>);
<a name="l00778"></a>00778       <span class="keywordflow">if</span> (itm1.the_production().index() &lt; itm2.the_production().index())
<a name="l00779"></a>00779         System.err.println(<span class="stringliteral">&quot;the first production.\n&quot;</span>);
<a name="l00780"></a>00780       <span class="keywordflow">else</span>
<a name="l00781"></a>00781         System.err.println(<span class="stringliteral">&quot;the second production.\n&quot;</span>);
<a name="l00782"></a>00782 
<a name="l00783"></a>00783       <span class="comment">/* count the conflict */</span>
<a name="l00784"></a>00784       <a class="code" href="classjava__cup_1_1emit.html">emit</a>.<a class="code" href="classjava__cup_1_1emit.html#a88929d9ab87ed756fc0716416b32e59b">num_conflicts</a>++;
<a name="l00785"></a>00785       <a class="code" href="classjava__cup_1_1lexer.html">lexer</a>.<a class="code" href="classjava__cup_1_1lexer.html#aa92554f0b8af788c8d226bcff5e7765e">warning_count</a>++;
<a name="l00786"></a>00786     }
<a name="l00787"></a>00787 
<a name="l00788"></a>00788   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00789"></a>00789 
<a name="l00795"></a><a class="code" href="classjava__cup_1_1lalr__state.html#a9104f87fd9f391195ee6a6c6bc552eab">00795</a>   <span class="keyword">protected</span> <span class="keywordtype">void</span> <a class="code" href="classjava__cup_1_1lalr__state.html#a9104f87fd9f391195ee6a6c6bc552eab">report_shift_reduce</a>(
<a name="l00796"></a>00796     <a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a> red_itm, 
<a name="l00797"></a>00797     <span class="keywordtype">int</span>       conflict_sym)
<a name="l00798"></a>00798     <span class="keywordflow">throws</span> <a class="code" href="classjava__cup_1_1internal__error.html">internal_error</a>
<a name="l00799"></a>00799     {
<a name="l00800"></a>00800       <a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a>    itm;
<a name="l00801"></a>00801       <a class="code" href="classjava__cup_1_1symbol.html">symbol</a>       shift_sym;
<a name="l00802"></a>00802 
<a name="l00803"></a>00803       <span class="comment">/* emit top part of message including the reduce item */</span>
<a name="l00804"></a>00804       System.err.println(<span class="stringliteral">&quot;*** Shift/Reduce conflict found in state #&quot;</span>+<a class="code" href="classjava__cup_1_1lalr__state.html#a4739bfae64234f684f099013d301522c">index</a>());
<a name="l00805"></a>00805       System.err.print  (<span class="stringliteral">&quot;  between &quot;</span>);
<a name="l00806"></a>00806       System.err.println(red_itm.to_simple_string());
<a name="l00807"></a>00807 
<a name="l00808"></a>00808       <span class="comment">/* find and report on all items that shift under our conflict symbol */</span>
<a name="l00809"></a>00809       <span class="keywordflow">for</span> (Enumeration itms = <a class="code" href="classjava__cup_1_1lalr__state.html#a79f7c20c7a43b52f36dfd4531c824732">items</a>().<a class="code" href="classjava__cup_1_1lalr__item__set.html#ab276bc588c75f4f22e46baf01bbcd0b7">all</a>(); itms.hasMoreElements(); )
<a name="l00810"></a>00810         {
<a name="l00811"></a>00811           itm = (<a class="code" href="classjava__cup_1_1lalr__item.html">lalr_item</a>)itms.nextElement();
<a name="l00812"></a>00812 
<a name="l00813"></a>00813           <span class="comment">/* only look if its not the same item and not a reduce */</span>
<a name="l00814"></a>00814           <span class="keywordflow">if</span> (itm != red_itm &amp;&amp; !itm.<a class="code" href="classjava__cup_1_1lr__item__core.html#ae3056b0c70648240cc9682f2af398d45">dot_at_end</a>())
<a name="l00815"></a>00815             {
<a name="l00816"></a>00816               <span class="comment">/* is it a shift on our conflicting terminal */</span>
<a name="l00817"></a>00817               shift_sym = itm.<a class="code" href="classjava__cup_1_1lr__item__core.html#a46e27ab1d918219e48e9720a834b2393">symbol_after_dot</a>();
<a name="l00818"></a>00818               <span class="keywordflow">if</span> (!shift_sym.<a class="code" href="classjava__cup_1_1symbol.html#af17ee2183b92a3fa0946ad0fd75eb0f8">is_non_term</a>() &amp;&amp; shift_sym.<a class="code" href="classjava__cup_1_1symbol.html#a427ae231940ae6b99d6b8983a16e18f8">index</a>() == conflict_sym)
<a name="l00819"></a>00819                 {
<a name="l00820"></a>00820                   <span class="comment">/* yes, report on it */</span>
<a name="l00821"></a>00821                   System.err.println(<span class="stringliteral">&quot;  and     &quot;</span> + itm.<a class="code" href="classjava__cup_1_1lr__item__core.html#a33e4f8867bd3dee4c5b885f262bb7477">to_simple_string</a>());
<a name="l00822"></a>00822                 }
<a name="l00823"></a>00823             }
<a name="l00824"></a>00824         }
<a name="l00825"></a>00825       System.err.println(<span class="stringliteral">&quot;  under symbol &quot;</span>+ <a class="code" href="classjava__cup_1_1terminal.html">terminal</a>.<a class="code" href="classjava__cup_1_1terminal.html#a22386de6f7027943b8bb5cacdabd9749">find</a>(conflict_sym).<a class="code" href="classjava__cup_1_1symbol.html#a2886f199df09de270d6ee498f7044793">name</a>());
<a name="l00826"></a>00826       System.err.println(<span class="stringliteral">&quot;  Resolved in favor of shifting.\n&quot;</span>);
<a name="l00827"></a>00827 
<a name="l00828"></a>00828       <span class="comment">/* count the conflict */</span>
<a name="l00829"></a>00829       <a class="code" href="classjava__cup_1_1emit.html">emit</a>.<a class="code" href="classjava__cup_1_1emit.html#a88929d9ab87ed756fc0716416b32e59b">num_conflicts</a>++;
<a name="l00830"></a>00830       <a class="code" href="classjava__cup_1_1lexer.html">lexer</a>.<a class="code" href="classjava__cup_1_1lexer.html#aa92554f0b8af788c8d226bcff5e7765e">warning_count</a>++;
<a name="l00831"></a>00831     }
<a name="l00832"></a>00832 
<a name="l00833"></a>00833   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00834"></a>00834 
<a name="l00836"></a><a class="code" href="classjava__cup_1_1lalr__state.html#a2f8a5292f1bc14bb2b2671537d42007c">00836</a>   <span class="keyword">public</span> <span class="keywordtype">boolean</span> <a class="code" href="classjava__cup_1_1lalr__state.html#a2f8a5292f1bc14bb2b2671537d42007c">equals</a>(<a class="code" href="classjava__cup_1_1lalr__state.html">lalr_state</a> other)
<a name="l00837"></a>00837     {
<a name="l00838"></a>00838       <span class="comment">/* we are equal if our item sets are equal */</span>
<a name="l00839"></a>00839       <span class="keywordflow">return</span> other != null &amp;&amp; <a class="code" href="classjava__cup_1_1lalr__state.html#a79f7c20c7a43b52f36dfd4531c824732">items</a>().<a class="code" href="classjava__cup_1_1lalr__item__set.html#a47f614ea94e4b54c9c5a8e0b35c0e958">equals</a>(other.<a class="code" href="classjava__cup_1_1lalr__state.html#a79f7c20c7a43b52f36dfd4531c824732">items</a>());
<a name="l00840"></a>00840     }
<a name="l00841"></a>00841 
<a name="l00842"></a>00842   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00843"></a>00843 
<a name="l00845"></a><a class="code" href="classjava__cup_1_1lalr__state.html#a9f285851c55de7cb7b1a027722979715">00845</a>   <span class="keyword">public</span> <span class="keywordtype">boolean</span> <a class="code" href="classjava__cup_1_1lalr__state.html#a2f8a5292f1bc14bb2b2671537d42007c">equals</a>(Object other)
<a name="l00846"></a>00846     {
<a name="l00847"></a>00847       <span class="keywordflow">if</span> (!(other instanceof <a class="code" href="classjava__cup_1_1lalr__state.html">lalr_state</a>))
<a name="l00848"></a>00848         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00849"></a>00849       <span class="keywordflow">else</span>
<a name="l00850"></a>00850         <span class="keywordflow">return</span> <a class="code" href="classjava__cup_1_1lalr__state.html#a2f8a5292f1bc14bb2b2671537d42007c">equals</a>((lalr_state)other);
<a name="l00851"></a>00851     }
<a name="l00852"></a>00852 
<a name="l00853"></a>00853   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00854"></a>00854 
<a name="l00856"></a><a class="code" href="classjava__cup_1_1lalr__state.html#a85e8cda19bf2356c9722c833262a9341">00856</a>   <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classjava__cup_1_1lalr__state.html#a85e8cda19bf2356c9722c833262a9341">hashCode</a>()
<a name="l00857"></a>00857     {
<a name="l00858"></a>00858       <span class="comment">/* just use the item set hash code */</span>
<a name="l00859"></a>00859       <span class="keywordflow">return</span> <a class="code" href="classjava__cup_1_1lalr__state.html#a79f7c20c7a43b52f36dfd4531c824732">items</a>().<a class="code" href="classjava__cup_1_1lalr__item__set.html#a6798571804429b61c372b87244f5ee3f">hashCode</a>();
<a name="l00860"></a>00860     }
<a name="l00861"></a>00861 
<a name="l00862"></a>00862   <span class="comment">/*. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .*/</span>
<a name="l00863"></a>00863 
<a name="l00865"></a><a class="code" href="classjava__cup_1_1lalr__state.html#a9a170eace1e9b641d03d6cb8cb269f05">00865</a>   <span class="keyword">public</span> String <a class="code" href="classjava__cup_1_1lalr__state.html#a9a170eace1e9b641d03d6cb8cb269f05">toString</a>()
<a name="l00866"></a>00866     {
<a name="l00867"></a>00867       String result;
<a name="l00868"></a>00868       <a class="code" href="classjava__cup_1_1lalr__transition.html">lalr_transition</a> tr;
<a name="l00869"></a>00869 
<a name="l00870"></a>00870       <span class="comment">/* dump the item set */</span>
<a name="l00871"></a>00871       result = <span class="stringliteral">&quot;lalr_state [&quot;</span> + <a class="code" href="classjava__cup_1_1lalr__state.html#a4739bfae64234f684f099013d301522c">index</a>() + <span class="stringliteral">&quot;]: &quot;</span> + <a class="code" href="classjava__cup_1_1lalr__state.html#ad33394e5cb5e5bedd773c6f24f4bf10d">_items</a> + <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00872"></a>00872 
<a name="l00873"></a>00873       <span class="comment">/* do the transitions */</span>
<a name="l00874"></a>00874       <span class="keywordflow">for</span> (tr = <a class="code" href="classjava__cup_1_1lalr__state.html#ad3c1f8e5f82060f48717a8a4a7561fc1">transitions</a>(); tr != null; tr = tr.<a class="code" href="classjava__cup_1_1lalr__transition.html#a7ec6a2cca99b57a9d0e53ed2cca9028e">next</a>())
<a name="l00875"></a>00875         {
<a name="l00876"></a>00876           result += tr;
<a name="l00877"></a>00877           result += <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00878"></a>00878         }
<a name="l00879"></a>00879 
<a name="l00880"></a>00880       <span class="keywordflow">return</span> result;
<a name="l00881"></a>00881     }
<a name="l00882"></a>00882 
<a name="l00883"></a>00883   <span class="comment">/*-----------------------------------------------------------*/</span>
<a name="l00884"></a>00884 }
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="lalr__state_8java.html">lalr_state.java</a>      </li>

    <li class="footer">Generated on Thu Oct 25 2012 09:48:31 for Jamus Scheme by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
